# æœºåœºè®¢é˜…ï¼Œåç§°ä¸èƒ½é‡å¤
proxy-providers:
  provide:
    type: http
    interval: 3600
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
    proxy: direct
    url: ""  

# å…¨å±€é…ç½®
allow-lan: true # å…è®¸å±€åŸŸç½‘è¿æ¥
bind-address: "*" # ç»‘å®š IP åœ°å€ï¼Œä»…ä½œç”¨äº allow-lan ä¸º trueï¼Œ'*'è¡¨ç¤ºæ‰€æœ‰åœ°å€
lan-allowed-ips: # å…è®¸è¿æ¥çš„ IP åœ°å€æ®µï¼Œä»…ä½œç”¨äº allow-lan ä¸º true, é»˜è®¤å€¼ä¸º 0.0.0.0/0 å’Œ::/0
  - 0.0.0.0/0
  - ::/0
skip-auth-prefixes: # è®¾ç½®è·³è¿‡éªŒè¯çš„ IP æ®µ
  - 127.0.0.1/8
  - ::1/128
mode: rule # æ­¤é¡¹æ‹¥æœ‰é»˜è®¤å€¼ï¼Œé»˜è®¤ä¸ºè§„åˆ™æ¨¡å¼
log-level: info # æ—¥å¿—ç­‰çº§ silent/error/warning/info/debug
ipv6: false
find-process-mode: off # æ§åˆ¶æ˜¯å¦è®© Clash å»åŒ¹é…è¿›ç¨‹
profile: # ç­–ç•¥ç»„é€‰æ‹©å’Œfakeipç¼“å­˜
  store-selected: true
  # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-fake-ip: true
  # å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€
unified-delay: true # å¼€å¯ç»Ÿä¸€å»¶è¿Ÿæ—¶ï¼Œä¼šè®¡ç®— RTTï¼Œä»¥æ¶ˆé™¤è¿æ¥æ¡æ‰‹ç­‰å¸¦æ¥çš„ä¸åŒç±»å‹èŠ‚ç‚¹çš„å»¶è¿Ÿå·®å¼‚
tcp-concurrent: true # TCPå¹¶å‘
global-client-fingerprint: chrome # å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹

# ç«¯å£
port: 8080 # HTTP(S) ä»£ç†æœåŠ¡å™¨ç«¯å£
socks-port: 1080 # SOCKS5 ä»£ç†ç«¯å£
mixed-port: 7890 # HTTP(S) å’Œ SOCKS ä»£ç†æ··åˆç«¯å£
redir-port: 7891 # é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux å’Œ MacOS
tproxy-port: 7892 # Transparent proxy server port for Linux (TProxy TCP and TProxy UDP)
global-ua: clash.meta # è‡ªå®šä¹‰å¤–éƒ¨èµ„æºä¸‹è½½æ—¶ä½¿ç”¨çš„çš„ UAï¼Œé»˜è®¤ä¸º clash.meta
etag-support: true # å¤–éƒ¨èµ„æºä¸‹è½½çš„ ETag æ”¯æŒï¼Œé»˜è®¤ä¸º true
geodata-mode: false # å¯é€‰ true/false,trueä¸º dat,falseä¸ºmmdb
geodata-loader: memconservative # standardï¼šæ ‡å‡†åŠ è½½å™¨,memconservativeï¼šä¸“ä¸ºå†…å­˜å—é™ (å°å†…å­˜) è®¾å¤‡ä¼˜åŒ–çš„åŠ è½½å™¨ (é»˜è®¤å€¼)
geo-auto-update: false # è‡ªåŠ¨æ›´æ–° GEO
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼Œå•ä½ä¸ºå°æ—¶
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.metadb"

# æµé‡å—…æ¢
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"
  
# DNSæ¨¡å—
dns:
  enable: true
  ipv6: false  # å…è®¸è§£æ IPv6
  listen: 0.0.0.0:1053
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  prefer-h3: true
  use-system-hosts: false
  use-hosts: false
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "+.lan"
    - "+.local"
    - "rule-set:cn_domain"
    - "rule-set:private_domain"
    - "rule-set:fakeip-filter"
  default-nameserver:
    - 127.0.0.1:5353
  proxy-server-nameserver:
    - 127.0.0.1:5353
  nameserver:
    - 127.0.0.1:5353
  nameserver-policy:
    "rule-set:cn_domain,private_domain,rule-direct_domain":
      - "https://dns.alidns.com/dns-query"
      - "https://doh.pub/dns-query" 
    "rule-set:geolocation-!cn,rule-proxy_domain":
      - "https://dns.cloudflare.com/dns-query"
      - "https://dns.google/dns-query"
      
# Tuné…ç½®
tun:
  enable: true
  stack: system # gvisor/mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true # è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±ï¼Œå¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥ tun ç½‘å¡
  auto-redirect: true # ä»…æ”¯æŒ Linuxï¼Œè‡ªåŠ¨é…ç½® iptables/nftables ä»¥é‡å®šå‘ TCP è¿æ¥ï¼Œéœ€è¦auto-routeå·²å¯ç”¨
  auto-detect-interface: true # è‡ªåŠ¨é€‰æ‹©æµé‡å‡ºå£æ¥å£ï¼Œå¤šå‡ºå£ç½‘å¡åŒæ—¶è¿æ¥çš„è®¾å¤‡å»ºè®®æ‰‹åŠ¨æŒ‡å®šå‡ºå£ç½‘å¡

proxies:
- name: "direct"
  type: direct
  udp: true
 
# é”šç‚¹
pr: &pr {type: select, proxies: [proxy, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹, ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹, ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, direct]}
# ç­–ç•¥ç»„
proxy-groups:
  - {name: proxy, type: select, proxies: [ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹, ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹, ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, direct],icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/ClashMeta.png}
  - {name: Google,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/Google.png}
  - {name: OpenAi,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/Copilot.png}
  - {name: TikTok,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/TikTok.png}
  - {name: Disney,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/Netflix.png}
  - {name: Netflix,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/Disney+.png}
  - {name: Telegram,!!merge <<: *pr,icon: https://raw.githubusercontent.com/sunfing/iNg/main/Icons/GeneralIcons/Telegram.png}
  - {name: ğŸš§ å…œåº•,!!merge <<: *pr}
  - {name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)æ¸¯|hk|hongkong"}
  - {name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)å°|tw|taiwan"}
  - {name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)æ—¥|jp|japan"}
  - {name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)ç¾|us|unitedstates"}
  - {name: ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)å¾·|de|Deutschland"}
  - {name: ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹, type: select, include-all: true, filter: "(?i)è·|nl|Nederland"}
  - {name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹, type: select, include-all: true}

rules:
  - IP-CIDR, 198.18.0.1/16, REJECT, no-resolve
  - RULE-SET,openai,OpenAi
  - RULE-SET,tiktok_domain,TikTok
  - RULE-SET,disney_domain,Disney
  - RULE-SET,netflix_domain,Netflix
  - RULE-SET,telegram_domain,Telegram
  - RULE-SET,google_domain,Google
  - RULE-SET,rule-direct_domain,direct
  - RULE-SET,geolocation-!cn,proxy
  - RULE-SET,rule-proxy_domain,proxy
  - RULE-SET,private_domain,direct
  - RULE-SET,cn_domain,direct

  - RULE-SET,netflix_ip,Netflix,no-resolve
  - RULE-SET,telegram_ip,Telegram,no-resolve
  - RULE-SET,google_ip,Google,no-resolve
  - RULE-SET,private_ip,direct,no-resolve
  - RULE-SET,cn_ip,direct,no-resolve

  - MATCH,ğŸš§ å…œåº•


rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
  list: &list {type: http, interval: 86400, behavior: domain, format: text}
  class: &class {type: http, interval: 86400, behavior: classical, format: text}
rule-providers:
  cn_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs"}
  private_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs"}
  rule-direct_domain: {!!merge <<: *list, url: "https://testingcf.jsdelivr.net/gh/Maple-Ling/maple@main/Mihomo/rule-direct.list"}
  rule-proxy_domain: {!!merge <<: *list, url: "https://testingcf.jsdelivr.net/gh/Maple-Ling/maple@main/Mihomo/rule-proxy.list"}
  openai: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/openai.mrs"}
  google_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.mrs"}
  tiktok_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/tiktok.mrs"}
  disney_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/disney.mrs"}
  fakeip-filter: {!!merge <<: *domain, url: "https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/fakeip-filter.mrs"}
  netflix_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/netflix.mrs"}
  telegram_domain: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs"}
  geolocation-!cn: {!!merge <<: *domain, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.mrs"}
  cn_ip: {!!merge <<: *ip, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs"}
  private_ip: {!!merge <<: *ip, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs"}
  google_ip: {!!merge <<: *ip, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.mrs"}
  netflix_ip: {!!merge <<: *ip, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/netflix.mrs"}
  telegram_ip: {!!merge <<: *ip, url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs"}